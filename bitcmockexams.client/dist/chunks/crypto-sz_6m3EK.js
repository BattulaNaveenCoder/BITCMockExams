const b="bitc-review-suite-secret-2025";const l=new TextEncoder,A=new TextDecoder;function s(n){const t=new Uint8Array(n);let r="";for(let e=0;e<t.length;e++)r+=String.fromCharCode(t[e]);return btoa(r)}function a(n){const t=atob(n),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r.buffer}async function u(n){const t=await crypto.subtle.importKey("raw",l.encode(b),{name:"PBKDF2"},!1,["deriveKey"]);return crypto.subtle.deriveKey({name:"PBKDF2",salt:n,iterations:1e5,hash:"SHA-256"},t,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}function y(n){const t=new Uint8Array(n);return crypto.getRandomValues(t),t.buffer}async function B(n){const t=y(16),r=y(12),e=await u(t),o=l.encode(JSON.stringify(n)),c=await crypto.subtle.encrypt({name:"AES-GCM",iv:r},e,o);return["v1",s(t),s(r),s(c)].join(":")}async function h(n){try{const t=n.split(":");if(t.length!==4)return null;const[r,e,o,c]=t;if(r!=="v1")return null;const i=a(e),d=a(o),S=a(c),f=await u(i),p=await crypto.subtle.decrypt({name:"AES-GCM",iv:d},f,S),E=A.decode(p);return JSON.parse(E)}catch{return null}}export{h as d,B as e};
